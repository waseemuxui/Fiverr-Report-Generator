<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fiverr Order Report Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="importmap">
    {
      "imports": {
        "react/": "https://aistudiocdn.com/react@19.2.0/",
        "react": "https://aistudiocdn.com/react@19.2.0",
        "react-dom/client": "https://aistudiocdn.com/react-dom@19.2.0/client",
        "@google/genai": "https://aistudiocdn.com/@google/genai@1.29.0",
        "jspdf": "https://esm.sh/jspdf@2.5.1",
        "jspdf-autotable": "https://esm.sh/jspdf-autotable@3.8.2"
      }
    }
    </script>
    <style>
      /* Simple style for number and date inputs to match the theme */
      .themed-input {
        background-color: #1e293b; /* slate-800 */
        border: 1px solid #475569; /* slate-600 */
        border-radius: 0.375rem; /* rounded-md */
        padding: 0.25rem 0.5rem;
        color: #cbd5e1; /* slate-300 */
        transition: border-color 0.2s, box-shadow 0.2s;
        width: 100%;
      }
      .themed-input:focus {
        outline: none;
        border-color: #6366f1; /* indigo-500 */
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5);
      }
      /* Fix for date picker icon color in dark mode */
      input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(0.8);
      }
      /* Webkit browsers styles for number input */
      .themed-input::-webkit-inner-spin-button,
      .themed-input::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      .themed-input {
        -moz-appearance: textfield;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fadeIn {
        animation: fadeIn 0.3s ease-out forwards;
      }
      /* Custom scrollbar for table */
      .custom-scrollbar::-webkit-scrollbar {
        height: 8px;
        width: 8px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #1e293b;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #475569;
        border-radius: 4px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #64748b;
      }
    </style>
</head>
<body class="bg-slate-900 text-slate-200">
    <div id="root"></div>
    <script type="text/babel" data-type="module">
        import React, { useState, useMemo, useEffect, useRef } from 'react';
        import ReactDOM from 'react-dom/client';
        import { GoogleGenAI, Type } from "@google/genai";
        // FIXED: Use named import for jspdf from esm.sh
        import { jsPDF } from 'jspdf';
        import autoTable from 'jspdf-autotable';

        const EXCHANGE_RATE = 278; // Default estimated exchange rate USD to PKR

        // --- ICONS ---
        const SparklesIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z" />
          </svg>
        );

        const ClearIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M12 9.75 14.25 12m0 0 2.25 2.25M14.25 12 12 14.25m-2.58 4.92-6.374-6.375a1.125 1.125 0 0 1 0-1.59L9.42 4.83c.21-.211.497-.33.795-.33H19.5a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25h-9.284c-.298 0-.585-.119-.795-.33Z" />
            </svg>
        );
        
        const DownloadIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
            </svg>
        );

        const AlertIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className}>
            <path fillRule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clipRule="evenodd" />
          </svg>
        );

        const CalculatorIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 15.75V18m-7.5-6.75h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25v-.008Zm2.25-4.5h.008v.008H10.5v-.008Zm0 2.25h.008v.008H10.5v-.008Zm0 2.25h.008v.008H10.5v-.008Zm2.25-4.5h.008v.008H12.75v-.008Zm0 2.25h.008v.008H12.75v-.008Zm0 2.25h.008v.008H12.75v-.008Zm2.25-4.5h.008v.008H15v-.008Zm0 2.25h.008v.008H15v-.008Zm0 2.25h.008v.008H15v-.008ZM7.5 10.5h3v3h-3v-3Zm3-3h3v3h-3v-3Zm-3 0h3v3h-3v-3Zm9-3h-9a2.25 2.25 0 0 0-2.25 2.25v12a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-12a2.25 2.25 0 0 0-2.25-2.25Z" />
            </svg>
        );

        const UserGroupIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
            </svg>
        );

        const BriefcaseIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.67.38m-2.72-11.528c-.08-.016-.16-.024-.24-.025h-9.84c-.08 0-.16.009-.24.025m2.72 11.528a9.427 9.427 0 0 1-2.72.632m-4.5-8.006a2.18 2.18 0 0 1-.75-1.661V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z" />
            </svg>
        );

        const PlusIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={className}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
        );

        const TrashIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
              <path strokeLinecap="round" strokeLinejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
            </svg>
        );

        const CheckIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={className}>
              <path strokeLinecap="round" strokeLinejoin="round" d="m4.5 12.75 6 6 9-13.5" />
            </svg>
        );
        
        const DocumentTextIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>
        );

        const ClockIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
        );

        const PaperAirplaneIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
            </svg>
        );

        // --- GEMINI SERVICE & ERROR HANDLING ---
        const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });

        const orderSchema = {
          type: Type.ARRAY,
          items: {
            type: Type.OBJECT,
            properties: {
              clientName: { type: Type.STRING, description: "The client's username." },
              description: { type: Type.STRING, description: "A concise description of the service provided." },
              date: { type: Type.STRING, description: "The date of the order, e.g., 'Nov 10'." },
              value: { type: Type.NUMBER, description: "The total numerical value of the order, including tips. Exclude $0 items." },
              status: { type: Type.STRING, description: "The current status of the order, e.g., 'Completed' or 'In Revision'." },
            },
            required: ["clientName", "description", "date", "value", "status"],
          },
        };

        const getFriendlyErrorMessage = (error) => {
            const msg = (error.message || error.toString()).toLowerCase();
            
            // Network / Connectivity
            if (msg.includes("fetch failed") || msg.includes("network")) {
                return {
                    title: "Network Error",
                    message: "Unable to reach the AI service.",
                    suggestion: "Please check your internet connection and try again."
                };
            }
            
            // API Specific
            if (msg.includes("401") || msg.includes("api key")) {
                return {
                    title: "Authentication Error",
                    message: "The API Key provided is invalid.",
                    suggestion: "Please check your environment configuration."
                };
            }
            if (msg.includes("429") || msg.includes("quota")) {
                return {
                    title: "Rate Limit Exceeded",
                    message: "Too many requests in a short time.",
                    suggestion: "Please wait a minute before trying again."
                };
            }
            if (msg.includes("500") || msg.includes("503") || msg.includes("overloaded")) {
                return {
                    title: "Service Unavailable",
                    message: "Google Gemini service is temporarily overloaded or down.",
                    suggestion: "Please try again in a few moments."
                };
            }
            if (msg.includes("400") || msg.includes("invalid argument")) {
                return {
                    title: "Invalid Request",
                    message: "The input text may be too long or malformed.",
                    suggestion: "Try processing a smaller chunk of text."
                };
            }

            // Parsing / Data
            if (msg.includes("json_parse_error") || msg.includes("syntaxerror")) {
                return {
                    title: "Parsing Failed",
                    message: "The AI response could not be understood.",
                    suggestion: "Your input might be ambiguous. Try cleaning up headers or extra text and try again."
                };
            }
            if (msg.includes("invalid_schema_format") || msg.includes("json array")) {
                return {
                    title: "Format Error",
                    message: "The AI did not return a valid list of orders.",
                    suggestion: "Ensure the pasted text contains recognizable order data structure."
                };
            }
            if (msg.includes("safety") || msg.includes("blocked")) {
                return {
                    title: "Content Blocked",
                    message: "The AI refused to process the content due to safety settings.",
                    suggestion: "Ensure your input data does not contain sensitive or prohibited content."
                };
            }

            // Default
            return {
                title: "Unexpected Error",
                message: error.message || "An unknown error occurred.",
                suggestion: "Please try again or refresh the page."
            };
        };

        const parseOrderData = async (text) => {
          const prompt = `Parse the following Fiverr order report text into a structured JSON array. For each order, extract clientName, description, date, status, and calculate the total value by summing the base price and any tips. Ignore $0 items like 'Extend Delivery'. Adhere strictly to the provided JSON schema. Text to parse: \n---\n${text}\n---`;

          try {
            const response = await ai.models.generateContent({
              model: "gemini-2.5-flash",
              contents: prompt,
              config: {
                responseMimeType: "application/json",
                responseSchema: orderSchema,
              },
            });

            const jsonString = response.text.trim();
            let parsedData;
            try {
                parsedData = JSON.parse(jsonString);
            } catch (e) {
                // Label specific parsing errors so helper can identify them
                throw new Error("JSON_PARSE_ERROR: " + e.message);
            }
            
            if (!Array.isArray(parsedData)) {
              throw new Error("INVALID_SCHEMA_FORMAT: Response was not a JSON array.");
            }
            // Add unique ID and cost property
            return parsedData.map((order, i) => ({ 
                ...order, 
                id: i, 
                sheetName: '', // New Field
                expense: 0     // New Field
            }));
          } catch (error) {
            console.error("Error details:", error);
            // Re-throw to be caught by the App component
            throw error;
          }
        };

        // --- SUB-COMPONENTS & TOOLS ---
        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-fadeIn">
                <div className="bg-slate-800 rounded-xl border border-slate-700 shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]">
                    <div className="flex justify-between items-center p-4 border-b border-slate-700 bg-slate-800/80">
                        <h3 className="text-xl font-bold text-white flex items-center gap-2">{title}</h3>
                        <button onClick={onClose} className="text-slate-400 hover:text-white transition-colors p-1 rounded hover:bg-slate-700">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                            <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                    <div className="p-6 overflow-y-auto custom-scrollbar">
                        {children}
                    </div>
                </div>
                </div>
            );
        };

        const FeeCalculatorTool = () => {
            const [amount, setAmount] = useState(100);
            const [serviceFee, setServiceFee] = useState(20);
            const [processingFee, setProcessingFee] = useState(1); // e.g. 1% for transfer

            const serviceFeeAmount = (amount * serviceFee) / 100;
            const afterServiceFee = amount - serviceFeeAmount;
            const processingFeeAmount = (afterServiceFee * processingFee) / 100;
            const netProfit = afterServiceFee - processingFeeAmount;

            return (
                <div className="space-y-6">
                    {/* Inputs */}
                    <div className="grid grid-cols-1 gap-4">
                        <div>
                            <label className="block text-sm font-medium text-slate-400 mb-1">Order Value ($)</label>
                            <div className="relative">
                                <span className="absolute left-3 top-2.5 text-slate-500">$</span>
                                <input type="number" value={amount} onChange={e => setAmount(Number(e.target.value))} className="themed-input pl-6 text-white" />
                            </div>
                        </div>
                        <div className="grid grid-cols-2 gap-4">
                            <div>
                                <label className="block text-sm font-medium text-slate-400 mb-1">Fiverr Fee (%)</label>
                                <input type="number" value={serviceFee} onChange={e => setServiceFee(Number(e.target.value))} className="themed-input" />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-slate-400 mb-1">Payment Fee (%)</label>
                                <input type="number" value={processingFee} onChange={e => setProcessingFee(Number(e.target.value))} className="themed-input" />
                            </div>
                        </div>
                    </div>
                    {/* Results */}
                    <div className="bg-slate-900/50 p-5 rounded-lg border border-slate-700 space-y-3">
                        <div className="flex justify-between text-sm text-slate-400">
                            <span>Service Fee Deduction:</span>
                            <span className="text-red-400 font-mono">-${serviceFeeAmount.toFixed(2)}</span>
                        </div>
                        <div className="flex justify-between text-sm text-slate-400">
                            <span>Payment Fee Deduction:</span>
                            <span className="text-red-400 font-mono">-${processingFeeAmount.toFixed(2)}</span>
                        </div>
                        <div className="pt-3 border-t border-slate-700 flex justify-between items-center">
                            <span className="text-slate-200 font-medium">Net Profit:</span>
                            <span className="text-3xl font-bold text-emerald-400">${netProfit.toFixed(2)}</span>
                        </div>
                        <div className="text-xs text-center text-slate-500 pt-2">
                             You keep <strong>{((netProfit / amount) * 100).toFixed(1)}%</strong> of your earnings.
                        </div>
                    </div>
                </div>
            )
        };

        const ClientManagerTool = () => {
            // Using dummy initial state for demonstration
            const [clients, setClients] = useState([
                { id: 1, name: "dons_downfall", note: "Regular buyer, likes fast delivery." },
                { id: 2, name: "creative_minds", note: "Requests revisions often. Charge extra." }
            ]);
            const [name, setName] = useState("");
            const [note, setNote] = useState("");

            const addClient = () => {
                if(!name.trim()) return;
                setClients([{ id: Date.now(), name, note }, ...clients]);
                setName("");
                setNote("");
            };

            const deleteClient = (id) => {
                setClients(clients.filter(c => c.id !== id));
            };

            return (
                <div className="space-y-4">
                    <div className="bg-slate-700/20 p-4 rounded-lg border border-slate-700/50 space-y-3">
                        <input 
                            placeholder="Client Username" 
                            value={name} 
                            onChange={e => setName(e.target.value)} 
                            className="themed-input" 
                        />
                        <textarea 
                            placeholder="Notes (preferences, rating, etc.)" 
                            value={note} 
                            onChange={e => setNote(e.target.value)} 
                            className="themed-input w-full h-20 text-sm resize-none" 
                        />
                        <button onClick={addClient} className="w-full py-2 bg-indigo-600 rounded-md text-white hover:bg-indigo-700 font-medium text-sm transition-colors flex items-center justify-center gap-2">
                            <PlusIcon className="w-4 h-4" /> Add Client
                        </button>
                    </div>
                    
                    <div className="space-y-2 max-h-60 overflow-y-auto pr-1 custom-scrollbar">
                        {clients.length === 0 && <p className="text-center text-slate-500 text-sm py-4 italic">No clients added yet.</p>}
                        {clients.map(client => (
                            <div key={client.id} className="bg-slate-700/30 p-3 rounded-lg flex justify-between items-start group hover:bg-slate-700/50 transition-colors">
                                <div className="flex-1 mr-2">
                                    <div className="font-semibold text-white text-sm">{client.name}</div>
                                    <div className="text-xs text-slate-400 mt-1 leading-relaxed">{client.note || "No notes."}</div>
                                </div>
                                <button onClick={() => deleteClient(client.id)} className="text-slate-500 hover:text-red-400 p-1">
                                    <TrashIcon className="w-4 h-4" />
                                </button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ProjectTrackerTool = () => {
            const [projects, setProjects] = useState([
                { id: 1, name: "Website Redesign for Mark", status: "pending" },
                { id: 2, name: "Logo Pack (3 Variations)", status: "done" }
            ]);
            const [newProject, setNewProject] = useState("");

            const addProject = (e) => {
                e.preventDefault();
                if (!newProject.trim()) return;
                setProjects([{ id: Date.now(), name: newProject, status: "pending" }, ...projects]);
                setNewProject("");
            };

            const toggleStatus = (id) => {
                setProjects(projects.map(p => 
                    p.id === id ? { ...p, status: p.status === "done" ? "pending" : "done" } : p
                ));
            };

            const deleteProject = (id) => {
                setProjects(projects.filter(p => p.id !== id));
            };

            return (
                <div className="space-y-4">
                     <form onSubmit={addProject} className="flex gap-2">
                        <input 
                            placeholder="New Project / Task..." 
                            value={newProject} 
                            onChange={e => setNewProject(e.target.value)} 
                            className="themed-input flex-1" 
                        />
                        <button type="submit" className="px-4 py-2 bg-emerald-600 rounded-md text-white hover:bg-emerald-700">
                             <PlusIcon className="w-5 h-5" />
                        </button>
                    </form>

                    <div className="space-y-2 max-h-60 overflow-y-auto pr-1 custom-scrollbar">
                        {projects.length === 0 && <p className="text-center text-slate-500 text-sm py-4 italic">No active projects.</p>}
                        {projects.map(project => (
                            <div key={project.id} className={`p-3 rounded-lg flex items-center justify-between border transition-all duration-200 ${project.status === 'done' ? 'bg-slate-800/50 border-slate-700/50 opacity-70' : 'bg-slate-700/30 border-slate-600'}`}>
                                <div className="flex items-center gap-3 flex-1 overflow-hidden">
                                    <button 
                                        onClick={() => toggleStatus(project.id)}
                                        className={`w-5 h-5 rounded border flex items-center justify-center transition-colors ${project.status === 'done' ? 'bg-emerald-500 border-emerald-500 text-white' : 'border-slate-500 hover:border-emerald-400'}`}
                                    >
                                        {project.status === 'done' && <CheckIcon className="w-3.5 h-3.5" />}
                                    </button>
                                    <span className={`text-sm truncate ${project.status === 'done' ? 'line-through text-slate-500' : 'text-slate-200'}`}>
                                        {project.name}
                                    </span>
                                </div>
                                <button onClick={() => deleteProject(project.id)} className="text-slate-500 hover:text-red-400 ml-2">
                                     <TrashIcon className="w-4 h-4" />
                                </button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const WordCounterTool = () => {
            const [text, setText] = useState("");
            
            const words = text.trim() === "" ? 0 : text.trim().split(/\s+/).length;
            const chars = text.length;
            const readingTime = Math.ceil(words / 200);

            return (
                <div className="space-y-4">
                    <textarea 
                        className="themed-input h-40 resize-none text-sm" 
                        placeholder="Paste your text here to count words..."
                        value={text}
                        onChange={(e) => setText(e.target.value)}
                    ></textarea>
                    <div className="grid grid-cols-3 gap-3">
                        <div className="bg-slate-700/30 p-3 rounded-lg text-center">
                            <div className="text-2xl font-bold text-white">{words}</div>
                            <div className="text-xs text-slate-400 uppercase tracking-wide">Words</div>
                        </div>
                         <div className="bg-slate-700/30 p-3 rounded-lg text-center">
                            <div className="text-2xl font-bold text-white">{chars}</div>
                            <div className="text-xs text-slate-400 uppercase tracking-wide">Chars</div>
                        </div>
                         <div className="bg-slate-700/30 p-3 rounded-lg text-center">
                            <div className="text-2xl font-bold text-white">~{readingTime}</div>
                            <div className="text-xs text-slate-400 uppercase tracking-wide">Min Read</div>
                        </div>
                    </div>
                </div>
            );
        };

        const PomodoroTool = () => {
            const [timeLeft, setTimeLeft] = useState(25 * 60);
            const [isActive, setIsActive] = useState(false);
            const [mode, setMode] = useState('work'); // work | break
            
            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => {
                        setTimeLeft(timeLeft - 1);
                    }, 1000);
                } else if (timeLeft === 0) {
                    setIsActive(false);
                }
                return () => clearInterval(interval);
            }, [isActive, timeLeft]);

            const toggleTimer = () => setIsActive(!isActive);
            const resetTimer = () => {
                setIsActive(false);
                setTimeLeft(mode === 'work' ? 25 * 60 : 5 * 60);
            };
            const setWorkMode = () => {
                setMode('work');
                setIsActive(false);
                setTimeLeft(25 * 60);
            }
             const setBreakMode = () => {
                setMode('break');
                setIsActive(false);
                setTimeLeft(5 * 60);
            }

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            return (
                <div className="text-center space-y-6">
                    <div className="flex justify-center gap-4">
                        <button onClick={setWorkMode} className={`px-4 py-1 rounded-full text-xs font-medium transition-colors ${mode === 'work' ? 'bg-indigo-600 text-white' : 'bg-slate-700 text-slate-400'}`}>Work</button>
                        <button onClick={setBreakMode} className={`px-4 py-1 rounded-full text-xs font-medium transition-colors ${mode === 'break' ? 'bg-emerald-600 text-white' : 'bg-slate-700 text-slate-400'}`}>Break</button>
                    </div>
                    <div className="text-7xl font-mono font-bold text-white tracking-wider">
                        {formatTime(timeLeft)}
                    </div>
                    <div className="flex justify-center gap-4">
                        <button onClick={toggleTimer} className={`w-24 py-2 rounded-lg font-semibold transition-colors ${isActive ? 'bg-amber-600 hover:bg-amber-700 text-white' : 'bg-emerald-600 hover:bg-emerald-700 text-white'}`}>
                            {isActive ? 'Pause' : 'Start'}
                        </button>
                        <button onClick={resetTimer} className="w-24 py-2 rounded-lg font-semibold bg-slate-700 hover:bg-slate-600 text-slate-200 transition-colors">
                            Reset
                        </button>
                    </div>
                </div>
            );
        };

        const ProposalTool = () => {
            const [clientName, setClientName] = useState("");
            const [jobTitle, setJobTitle] = useState("");
            const [mySkills, setMySkills] = useState("");
            const [generated, setGenerated] = useState("");

            const generateProposal = () => {
                if(!clientName || !jobTitle) return;
                const text = `Hi ${clientName},

I noticed your posting for a "${jobTitle}" and I'd love to help you with it. 

I have extensive experience in ${mySkills || "this field"} and I am confident I can deliver high-quality results for you. I prioritize clear communication and timely delivery.

Let's discuss how we can get started!

Best regards,`;
                setGenerated(text);
            };

            const copyToClipboard = () => {
                navigator.clipboard.writeText(generated);
                alert("Copied to clipboard!");
            };

            return (
                <div className="space-y-4">
                    <div className="grid grid-cols-1 gap-3">
                         <input placeholder="Client Name" value={clientName} onChange={e => setClientName(e.target.value)} className="themed-input" />
                         <input placeholder="Job Title" value={jobTitle} onChange={e => setJobTitle(e.target.value)} className="themed-input" />
                         <input placeholder="My Key Skills (e.g., React, Logo Design)" value={mySkills} onChange={e => setMySkills(e.target.value)} className="themed-input" />
                         <button onClick={generateProposal} className="w-full py-2 bg-indigo-600 rounded-md text-white hover:bg-indigo-700 font-medium">Generate Proposal</button>
                    </div>
                    {generated && (
                        <div className="relative mt-4">
                             <textarea readOnly value={generated} className="w-full h-40 bg-slate-900 border border-slate-700 rounded-lg p-3 text-sm text-slate-300"></textarea>
                             <button onClick={copyToClipboard} className="absolute top-2 right-2 px-3 py-1 bg-slate-700 hover:bg-slate-600 text-xs text-white rounded">Copy</button>
                        </div>
                    )}
                </div>
            );
        };


        // --- COMPONENTS ---
        const OrderInput = ({ onGenerate, isLoading, onClear }) => {
          const [inputText, setInputText] = useState('');

          const placeholderText = `Paste your raw order data from Fiverr here. For example:
d
dons_downfall
build shopify store...
Nov 10	$200	
In Revision
...`;

          const handleGenerateClick = () => {
            if (inputText.trim()) onGenerate(inputText);
          };

          const handleClearClick = () => {
            setInputText('');
            onClear();
          };

          return (
            <div className="flex flex-col space-y-4 p-4 md:p-6 bg-slate-800/50 rounded-2xl border border-slate-700 shadow-lg">
              <label htmlFor="order-data" className="text-lg font-semibold text-slate-300">Fiverr Order Data</label>
              <textarea
                id="order-data"
                value={inputText}
                onChange={(e) => setInputText(e.target.value)}
                placeholder={placeholderText}
                className="w-full h-96 p-4 bg-slate-900 border border-slate-600 rounded-lg text-sm text-slate-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200 resize-y"
                disabled={isLoading}
              />
              <div className="flex flex-col sm:flex-row gap-4">
                <button
                  onClick={handleGenerateClick}
                  disabled={isLoading || !inputText.trim()}
                  className="flex-1 inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-indigo-500 disabled:bg-indigo-500/50 disabled:cursor-not-allowed transition-all duration-200"
                >
                  {isLoading ? 'Generating...' : <><SparklesIcon className="w-5 h-5 mr-2" /> Generate Report</>}
                </button>
                <button
                  onClick={handleClearClick}
                  disabled={isLoading}
                  className="inline-flex items-center justify-center px-6 py-3 border border-slate-600 text-base font-medium rounded-md shadow-sm text-slate-300 bg-slate-700 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-slate-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200"
                >
                  <ClearIcon className="w-5 h-5 mr-2" /> Clear
                </button>
              </div>
            </div>
          );
        };

        const StatusBadge = ({ status }) => {
            let colorClass = 'bg-slate-700 text-slate-300 border-slate-600';
            const s = status ? status.toLowerCase() : '';
            
            if (s.includes('complete') || s.includes('delivered')) {
                colorClass = 'bg-emerald-900/40 text-emerald-300 border-emerald-800';
            } else if (s.includes('revision')) {
                colorClass = 'bg-amber-900/40 text-amber-300 border-amber-800';
            } else if (s.includes('progress') || s.includes('active')) {
                colorClass = 'bg-blue-900/40 text-blue-300 border-blue-800';
            } else if (s.includes('cancel')) {
                colorClass = 'bg-rose-900/40 text-rose-300 border-rose-800';
            } else if (s.includes('late')) {
                colorClass = 'bg-red-900/40 text-red-300 border-red-800';
            }

            return (
                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${colorClass}`}>
                    {status}
                </span>
            );
        };

        const ErrorCard = ({ error, onClear }) => {
            if (!error) return null;
            const { title, message, suggestion } = getFriendlyErrorMessage(error);
            
            return (
                <div className="rounded-md bg-red-900/20 p-4 border border-red-800/50 animate-fadeIn my-4">
                    <div className="flex">
                        <div className="flex-shrink-0">
                            <AlertIcon className="h-5 w-5 text-red-400" />
                        </div>
                        <div className="ml-3 flex-1">
                            <h3 className="text-sm font-medium text-red-300">{title}</h3>
                            <div className="mt-2 text-sm text-red-400/90">
                                <p>{message}</p>
                            </div>
                            <div className="mt-1 text-xs text-red-400/70">
                                <p>{suggestion}</p>
                            </div>
                        </div>
                        <div className="ml-auto pl-3">
                          <div className="-mx-1.5 -my-1.5">
                            <button
                              type="button"
                              onClick={onClear}
                              className="inline-flex rounded-md p-1.5 text-red-400 hover:bg-red-900/40 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 focus:ring-offset-red-50 transition-colors"
                            >
                              <span className="sr-only">Dismiss</span>
                              <ClearIcon className="h-4 w-4" />
                            </button>
                          </div>
                        </div>
                    </div>
                </div>
            );
        };

        const ReportTable = ({ data, onUpdateField }) => {
            const totalValue = useMemo(() => {
                return data.reduce((sum, item) => sum + (Number(item.value) || 0), 0);
            }, [data]);
            
            const totalValuePKR = useMemo(() => {
                return data.reduce((sum, item) => sum + (Number(item.valuePKR) || 0), 0);
            }, [data]);

            const totalExpense = useMemo(() => {
                return data.reduce((sum, item) => sum + (Number(item.expense) || 0), 0);
            }, [data]);

            const downloadPDF = () => {
                const doc = new jsPDF();
                
                // Add SiteFixStudio.com header
                doc.setFontSize(22);
                doc.setTextColor(79, 70, 229); // Indigo
                doc.text("SiteFixStudio.com", 14, 20);

                doc.setFontSize(14);
                doc.setTextColor(40);
                doc.text("Fiverr Order Report", 14, 32);
                
                doc.setFontSize(10);
                doc.setTextColor(100);
                doc.text(`Generated on ${new Date().toLocaleDateString()}`, 14, 38);
                
                const tableBody = data.map(row => [
                    row.date,
                    row.clientName,
                    row.sheetName || '-',
                    row.description,
                    row.status,
                    `$${Number(row.value).toFixed(2)}`,
                    row.expense ? `$${Number(row.expense).toFixed(2)}` : '-',
                    `Rs ${Number(row.valuePKR).toLocaleString()}`
                ]);

                autoTable(doc, {
                    startY: 45,
                    head: [['Date', 'Client', 'Sheet', 'Description', 'Status', 'Value ($)', 'Exp ($)', 'Value (PKR)']],
                    body: tableBody,
                    foot: [['', '', '', '', 'Total', `$${totalValue.toFixed(2)}`, `$${totalExpense.toFixed(2)}`, `Rs ${totalValuePKR.toLocaleString()}`]],
                    theme: 'grid',
                    headStyles: { fillColor: [79, 70, 229] }, // Indigo 600
                    footStyles: { fillColor: [241, 245, 249], textColor: [15, 23, 42] }, // Slate 100
                    styles: { fontSize: 8, cellPadding: 2 },
                    columnStyles: {
                        5: { halign: 'right' }, // Value $
                        6: { halign: 'right' }, // Exp
                        7: { halign: 'right', fontStyle: 'bold' } // Value PKR
                    }
                });

                doc.save("fiverr_orders.pdf");
            };

            return (
                <div className="animate-fadeIn space-y-4">
                    <div className="flex justify-between items-center">
                        <h2 className="text-xl font-semibold text-white">Report Preview</h2>
                        <button 
                            onClick={downloadPDF}
                            className="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-emerald-500 transition-colors shadow-emerald-900/20"
                        >
                            <DownloadIcon className="w-4 h-4 mr-2" /> Download PDF
                        </button>
                    </div>
                    
                    <div className="bg-slate-800 rounded-lg shadow-lg overflow-hidden border border-slate-700">
                        <div className="overflow-x-auto custom-scrollbar">
                            <table className="min-w-full divide-y divide-slate-700">
                                <thead className="bg-slate-700/50">
                                    <tr>
                                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">Date</th>
                                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">Client</th>
                                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">Sheet Name</th>
                                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">Description</th>
                                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">Status</th>
                                        <th scope="col" className="px-6 py-3 text-right text-xs font-medium text-slate-300 uppercase tracking-wider">Value ($)</th>
                                        <th scope="col" className="px-6 py-3 text-right text-xs font-medium text-slate-300 uppercase tracking-wider">Exp ($)</th>
                                        <th scope="col" className="px-6 py-3 text-right text-xs font-medium text-slate-300 uppercase tracking-wider">Value (PKR)</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-slate-800 divide-y divide-slate-700">
                                    {data.map((order, idx) => (
                                        <tr key={idx} className="hover:bg-slate-700/30 transition-colors duration-150">
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-slate-300 font-mono">{order.date}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">{order.clientName}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-slate-300">
                                                 <input 
                                                    type="text" 
                                                    className="themed-input text-xs"
                                                    placeholder="Project Sheet"
                                                    value={order.sheetName}
                                                    onChange={(e) => onUpdateField(idx, 'sheetName', e.target.value)}
                                                />
                                            </td>
                                            <td className="px-6 py-4 text-sm text-slate-400 max-w-xs truncate" title={order.description}>{order.description}</td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <StatusBadge status={order.status} />
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-right text-emerald-400 font-mono font-medium">
                                                ${Number(order.value).toFixed(2)}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-right font-mono">
                                                <input 
                                                    type="number" 
                                                    className="themed-input w-20 text-right text-sm"
                                                    value={order.expense}
                                                    onChange={(e) => onUpdateField(idx, 'expense', e.target.value)}
                                                />
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-right font-mono">
                                                <input 
                                                    type="number" 
                                                    className="themed-input w-24 text-right text-sm"
                                                    value={order.valuePKR}
                                                    onChange={(e) => onUpdateField(idx, 'valuePKR', e.target.value)}
                                                />
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                                <tfoot className="bg-slate-700/30 font-semibold border-t border-slate-700">
                                    <tr>
                                        <td colSpan={5} className="px-6 py-4 text-sm text-slate-300 text-right uppercase tracking-wider">Totals</td>
                                        <td className="px-6 py-4 text-sm text-right text-emerald-400 font-mono text-base shadow-inner bg-slate-700/20">${totalValue.toFixed(2)}</td>
                                        <td className="px-6 py-4 text-sm text-right text-rose-400 font-mono text-base shadow-inner bg-slate-700/20">${totalExpense.toFixed(2)}</td>
                                        <td className="px-6 py-4 text-sm text-right text-emerald-400 font-mono text-base shadow-inner bg-slate-700/20">Rs {totalValuePKR.toLocaleString()}</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            );
        };

        const FreelancerTools = () => {
            const [activeTool, setActiveTool] = useState(null);

            const tools = {
                calculator: { title: "Fee Calculator", component: <FeeCalculatorTool /> },
                clients: { title: "Client Manager", component: <ClientManagerTool /> },
                projects: { title: "Project Tracker", component: <ProjectTrackerTool /> },
                wordcounter: { title: "Word Counter", component: <WordCounterTool /> },
                pomodoro: { title: "Pomodoro Timer", component: <PomodoroTool /> },
                proposal: { title: "Cover Letter Generator", component: <ProposalTool /> }
            };

            return (
                <div className="mt-16 pt-10 border-t border-slate-800 animate-fadeIn">
                     <div className="flex items-center gap-3 mb-6">
                        <h3 className="text-2xl font-bold text-white">Freelancer Toolkit</h3>
                        <span className="bg-indigo-500/20 text-indigo-300 text-xs font-medium px-2.5 py-0.5 rounded border border-indigo-500/30">Interactive Tools</span>
                     </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        {/* Fee Calculator Card */}
                        <div 
                            onClick={() => setActiveTool('calculator')}
                            className="group relative bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-indigo-500 transition-all duration-300 hover:shadow-xl hover:shadow-indigo-900/10 cursor-pointer"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                                <svg className="w-5 h-5 text-slate-500 group-hover:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                            </div>
                            <div className="w-12 h-12 rounded-lg bg-indigo-900/30 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                <CalculatorIcon className="w-6 h-6 text-indigo-400" />
                            </div>
                            <h4 className="text-lg font-semibold text-white mb-2">Fee Calculator</h4>
                            <p className="text-slate-400 text-sm">Instantly calculate Fiverr service fees, payment processing charges, and your final net profit.</p>
                        </div>

                        {/* Client Manager Card */}
                        <div 
                            onClick={() => setActiveTool('clients')}
                            className="group relative bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-cyan-500 transition-all duration-300 hover:shadow-xl hover:shadow-cyan-900/10 cursor-pointer"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                                <svg className="w-5 h-5 text-slate-500 group-hover:text-cyan-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                            </div>
                            <div className="w-12 h-12 rounded-lg bg-cyan-900/30 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                <UserGroupIcon className="w-6 h-6 text-cyan-400" />
                            </div>
                            <h4 className="text-lg font-semibold text-white mb-2">Client Manager</h4>
                            <p className="text-slate-400 text-sm">Keep track of regular buyers, add notes about preferences, and manage your client list.</p>
                        </div>

                        {/* Project Tracker Card */}
                        <div 
                            onClick={() => setActiveTool('projects')}
                            className="group relative bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-emerald-500 transition-all duration-300 hover:shadow-xl hover:shadow-emerald-900/10 cursor-pointer"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                                <svg className="w-5 h-5 text-slate-500 group-hover:text-emerald-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                            </div>
                            <div className="w-12 h-12 rounded-lg bg-emerald-900/30 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                <BriefcaseIcon className="w-6 h-6 text-emerald-400" />
                            </div>
                            <h4 className="text-lg font-semibold text-white mb-2">Project Tracker</h4>
                            <p className="text-slate-400 text-sm">Organize your work with a simple to-do list. Track active projects and deadlines.</p>
                        </div>

                        {/* Word Counter Card */}
                        <div 
                            onClick={() => setActiveTool('wordcounter')}
                            className="group relative bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-fuchsia-500 transition-all duration-300 hover:shadow-xl hover:shadow-fuchsia-900/10 cursor-pointer"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                                <svg className="w-5 h-5 text-slate-500 group-hover:text-fuchsia-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                            </div>
                            <div className="w-12 h-12 rounded-lg bg-fuchsia-900/30 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                <DocumentTextIcon className="w-6 h-6 text-fuchsia-400" />
                            </div>
                            <h4 className="text-lg font-semibold text-white mb-2">Word Counter</h4>
                            <p className="text-slate-400 text-sm">Count words, characters, and estimate reading time for your gig descriptions or deliverables.</p>
                        </div>

                         {/* Pomodoro Card */}
                         <div 
                            onClick={() => setActiveTool('pomodoro')}
                            className="group relative bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-amber-500 transition-all duration-300 hover:shadow-xl hover:shadow-amber-900/10 cursor-pointer"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                                <svg className="w-5 h-5 text-slate-500 group-hover:text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                            </div>
                            <div className="w-12 h-12 rounded-lg bg-amber-900/30 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                <ClockIcon className="w-6 h-6 text-amber-400" />
                            </div>
                            <h4 className="text-lg font-semibold text-white mb-2">Pomodoro Timer</h4>
                            <p className="text-slate-400 text-sm">Boost productivity with a focused work timer. Default intervals of 25 minutes work, 5 minutes break.</p>
                        </div>

                        {/* Proposal Generator Card */}
                         <div 
                            onClick={() => setActiveTool('proposal')}
                            className="group relative bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-teal-500 transition-all duration-300 hover:shadow-xl hover:shadow-teal-900/10 cursor-pointer"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                                <svg className="w-5 h-5 text-slate-500 group-hover:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                            </div>
                            <div className="w-12 h-12 rounded-lg bg-teal-900/30 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
                                <PaperAirplaneIcon className="w-6 h-6 text-teal-400" />
                            </div>
                            <h4 className="text-lg font-semibold text-white mb-2">Proposal Maker</h4>
                            <p className="text-slate-400 text-sm">Quickly generate a professional cover letter template for your buyer requests.</p>
                        </div>

                    </div>

                    <Modal 
                        isOpen={!!activeTool} 
                        onClose={() => setActiveTool(null)}
                        title={activeTool ? tools[activeTool].title : ''}
                    >
                        {activeTool && tools[activeTool].component}
                    </Modal>
                </div>
            );
        };

        const ContactView = () => (
            <div className="max-w-3xl mx-auto animate-fadeIn space-y-8">
                <header className="text-center space-y-3">
                    <h1 className="text-4xl font-extrabold tracking-tight text-white sm:text-5xl">
                        Contact <span className="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400">Us</span>
                    </h1>
                    <p className="text-lg text-slate-400 max-w-2xl mx-auto">
                        Have questions, suggestions, or need custom development? Reach out to us.
                    </p>
                </header>

                <div className="bg-slate-800 rounded-2xl border border-slate-700 p-8 shadow-xl">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                        <div className="space-y-6">
                            <h3 className="text-xl font-bold text-white">Get in Touch</h3>
                            <p className="text-slate-400 leading-relaxed">
                                We are always looking to improve our tools for the freelancer community.
                                If you found a bug or have a feature request, let us know!
                            </p>
                            
                            <div className="space-y-4">
                                <div className="flex items-center gap-4 text-slate-300">
                                    <div className="w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center text-indigo-400">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" /></svg>
                                    </div>
                                    <div className="flex flex-col">
                                        <span>support@sitefixstudio.com</span>
                                        <span className="text-sm text-slate-400">sitefixs@gmail.com</span>
                                    </div>
                                </div>
                                <div className="flex items-center gap-4 text-slate-300">
                                     <div className="w-10 h-10 rounded-full bg-cyan-900/50 flex items-center justify-center text-cyan-400">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S12 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S12 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 4.055v4.263" /></svg>
                                    </div>
                                    <span>www.sitefixstudio.com</span>
                                </div>
                            </div>
                        </div>

                        <div className="bg-slate-900/50 rounded-xl p-6 border border-slate-700/50">
                            <form className="space-y-4" onSubmit={(e) => e.preventDefault()}>
                                <div>
                                    <label className="block text-sm font-medium text-slate-400 mb-1">Name</label>
                                    <input type="text" className="themed-input" placeholder="Your Name" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-slate-400 mb-1">Message</label>
                                    <textarea className="themed-input h-32 resize-none" placeholder="How can we help?"></textarea>
                                </div>
                                <button className="w-full py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors">
                                    Send Message
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        );

        const App = () => {
            const [orderData, setOrderData] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [currentView, setCurrentView] = useState('home');

            const handleGenerate = async (text) => {
                setIsLoading(true);
                setError(null);
                setOrderData(null);
                try {
                    const data = await parseOrderData(text);
                    // Add PKR value (estimated)
                    const enrichedData = data.map(item => ({
                        ...item,
                        valuePKR: Math.round((item.value || 0) * EXCHANGE_RATE)
                    }));
                    setOrderData(enrichedData);
                } catch (err) {
                    setError(err);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleUpdateField = (index, field, newValue) => {
                setOrderData(prevData => {
                    const newData = [...prevData];
                    newData[index] = { ...newData[index], [field]: newValue };
                    return newData;
                });
            };

            const handleClear = () => {
                setOrderData(null);
                setError(null);
            };

            return (
                <div className="min-h-screen bg-slate-900 text-slate-200 font-sans">
                    {/* Header Bar */}
                    <nav className="bg-slate-800/50 backdrop-blur-md border-b border-slate-700 sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex h-16 items-center justify-between">
                                <div 
                                    className="flex items-center gap-2 cursor-pointer" 
                                    onClick={() => setCurrentView('home')}
                                >
                                    <div className="h-8 w-8 rounded-lg bg-gradient-to-br from-indigo-500 to-cyan-500 flex items-center justify-center text-white font-bold text-sm">
                                        SF
                                    </div>
                                    <span className="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400">
                                        SiteFixStudio.com
                                    </span>
                                </div>
                                
                                {/* Desktop Menu */}
                                <div className="hidden md:flex items-center space-x-8">
                                    <a 
                                        href="https://sitefixstudio.com" 
                                        className="text-sm font-medium text-slate-400 hover:text-white transition-colors"
                                    >
                                        Home
                                    </a>
                                    <button 
                                        onClick={() => setCurrentView('home')}
                                        className={`text-sm font-medium transition-colors ${currentView === 'home' ? 'text-white' : 'text-slate-400 hover:text-white'}`}
                                    >
                                        Report Tool
                                    </button>
                                    <button 
                                        onClick={() => setCurrentView('contact')}
                                        className={`text-sm font-medium transition-colors ${currentView === 'contact' ? 'text-white' : 'text-slate-400 hover:text-white'}`}
                                    >
                                        Contact Us
                                    </button>
                                </div>

                                {/* Mobile Menu Links */}
                                 <div className="md:hidden flex items-center gap-4">
                                     <a href="https://sitefixstudio.com" className="text-sm font-medium text-slate-400 hover:text-white">Home</a>
                                    <button onClick={() => setCurrentView('contact')} className="text-sm font-medium text-slate-400 hover:text-white">Contact</button>
                                 </div>
                            </div>
                        </div>
                    </nav>

                    <div className="py-12 px-4 sm:px-6 lg:px-8">
                        <div className="max-w-5xl mx-auto space-y-8">
                            {currentView === 'home' ? (
                                <>
                                    <header className="text-center space-y-3">
                                        <h1 className="text-4xl font-extrabold tracking-tight text-white sm:text-5xl">
                                            <span className="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400">Fiverr</span> Order Report
                                        </h1>
                                        <p className="text-lg text-slate-400 max-w-2xl mx-auto">
                                            Paste your raw order history and let AI transform it into a clean, professional report ready for export.
                                        </p>
                                    </header>

                                    <main className="space-y-6">
                                        <OrderInput onGenerate={handleGenerate} isLoading={isLoading} onClear={handleClear} />
                                        
                                        <ErrorCard error={error} onClear={() => setError(null)} />

                                        {orderData && (
                                            <div className="mt-8">
                                                <ReportTable data={orderData} onUpdateField={handleUpdateField} />
                                            </div>
                                        )}
                                        
                                        <FreelancerTools />
                                    </main>
                                </>
                            ) : (
                                <ContactView />
                            )}
                            
                            <footer className="text-center text-slate-600 text-sm mt-12 pt-8 border-t border-slate-800">
                                <p>Site Credit: SiteFixStudio.com</p>
                            </footer>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>